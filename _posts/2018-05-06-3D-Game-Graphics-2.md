---
layout: post
title: 3D Game Grahpics - Vertex Processing 
feature-img: "assets/img/sample_feature_img.png"
tags: [GameGraphics]
---

## Chapter2.  정점처리
### 렌더링 파이프 라인 개요

* 먼저 정점처리를 하기 전에 렌더링 파이프 라인에 대하여 간략하게 정리하고 넘어가자
* 렌더링 파이프 라인의 주요 요소
  * 정점처리 (vertex processing) - 래스터화 (rasterization) - 프래그먼트처리(fragment processing) - 출력 변합(output merging)
* 정점처리와 프래그먼트처리는 프로그래밍이 가능한 단계이고, 래스터화와 출력병합 단계는 프로그래밍이 불가능한 하드웨어로 고정된 단계다.
* 프로그래밍이 가능한 단계란 프로그래머가 원하는 방식으로 처리를 할 수 있는 단계이고, 정점셰이더와 프래그먼트셰이더가 그 예다. 
* 프로그래밍이 불가능한 단계는 처리 방식이 고정되어 있고 우리는 처리방식에서 제공하는 파라미터값을  입력하여 작동방식을 설정할 수 있다.
    
 ---------
####  정점처리
* 정점버퍼에 들어있는 모든 정점에 대하여 작동하며, 변환을 비롯한 다양한 정점별 연산을 수행한다.
* 정점에 대한 변환을 비롯한 정점에 대한 연산을 한다.
#### 래스터화 
* 변환된 정점에 대하여 프래그먼트를 생성해준다.
#### 프래그먼트처리
* 픽셀과 프래그먼트의 차이는 없는 것 같지만, 두가지는 다르다. 
* 먼저 프래그먼트란 래스터화에 따른 하나의 데이터 집단이고, 픽셀은 이 프래그먼트들에 대하여 알파블랜딩, z-버퍼링 등의 처리가 끝나고 나온 컬러 버퍼라는 메모리 공간에 저장된 애다.
* 픽셀은 화면의 한 점이라고 생각하면되고 이 픽셀이 되기 전의 데이터들의 집합을 프래그먼트라고 생각하면된다.
* 그래서 프래그먼트에 대한 처리는 텍스쳐링등, 프래그먼트들에 대하여 처리를 해주는 것이다. 
* 자세한 것은 프래그먼트 처리에서 하겠당~
#### 출력병합
* 위에서 말한 픽셀을 만들기 위한 단계가 출력병합 단계다. 알파블랜딩, z-버퍼링등이 출력병합에서 진행된다.

 ---------
### 변환
  
내가 화면에 출력하고자 하는 3D 메쉬 모델이 있고, 이 모델을 월드에 배치 했다고 하자.

모델의 중심의 위치와 회전각도에 따라 각 정점들의 위치를 결정을 해주어야 한다. 

그리고 카메라에서 월드에 배치된 모델을 바라봤을 때 위치도 결정이 되어야 한다. 

그리고 카메라 공간에서 멀리 있는 물체와 가까이있는 물체의 위치를 우리의 눈에 보이는 위치로 변환을 해주어야 한다. 

오브젝트 공간 -> 월드 공간 -> 카메라 공간 -> 클립공간

각 공간사이를 월드 변환, 뷰변환, 투영변환을 통해 변환한다.

### 월드변환
#### 아핀 변환과 동차좌표

* 월드 변환과 뷰변환은 축소 확대, 회전, 이동과 같이 기본적인 변환들을 조합하여 만들어진다. 
* 축소 확대, 회전은 선형변환이라고 하고 이동은 아핀변환이라고 한다. 
  * [선형변환] : <https://ko.wikipedia.org/wiki/%EC%84%A0%ED%98%95_%EB%B3%80%ED%99%98>
  * [아핀변환] : <https://ko.wikipedia.org/wiki/%EC%95%84%ED%95%80_%EB%B3%80%ED%99%98>
* 축소 확대
  * 3차원 공간의 s 만큼 축소 확대 행렬
 > $$
 \left[
 \begin{matrix}
 s& 0& 0\\
 0 & s& 0\\
 0& 0& s
 \end{matrix}
 \right]
$$
* 축에 대한 회전
  * 3차원 공간의 z축을 기준으로 x각도 만큼의 회전
>   $$
 \left[
 \begin{matrix}
 cosx& -sinx& 0\\
 sinx& cosx& 0\\
 0& 0& 1
 \end{matrix}
 \right]
$$
  * 순차 치환을 통해 x축과 y축으로  회전하는 것도 한번 행렬을 만들어 보자. 
* 이동
  * 축소 확대, 회전은 행렬의 곱으로 계산이 가능했다. 이동은 어떻게 하면 가능할까?! 
  * x 축으로 1만큼, y축으로 2만큼 z 축으로 3만큼 이동시키려면?
  





---------
[게임 프로그래밍을 위한 3차원 게임그래픽스 - 한정현] 참고 

틀린 부분이 있다면 메일로 알려 주면 수정하도록 함. OR 수정해줘도 됨